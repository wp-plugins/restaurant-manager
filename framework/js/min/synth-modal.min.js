function modal_support_sortables(){jQuery(".sortables").sortable({handle:"span"})}function modal_support_tinymce(t){var a=t.modal.find(".synth_tinymce"),e=t.modal.find(".synth-modal-save-event");a.each(function(){var t=this.id,a=jQuery(this),o=a.parents(".wp-editor-wrap:eq(0)"),n=o.find("textarea.synth_tinymce"),l=o.find(".wp-switch-editor").removeAttr("onclick"),s={id:this.id,buttons:"strong,em,link,block,del,ins,img,ul,ol,li,code,spell,close"};tinyVersion=window.tinyMCE.majorVersion,executeAdd="mceAddControl",executeRem="mceRemoveControl",tinyVersion>=4&&(executeAdd="mceAddEditor",executeRem="mceRemoveEditor"),quicktags(s),QTags._buttonsInit(),l.bind("click",function(){var a=jQuery(this);a.is(".switch-tmce")?(o.removeClass("html-active").addClass("tmce-active"),window.tinyMCE.execCommand(executeAdd,!0,t),window.tinyMCE.get(t).setContent(window.switchEditors.wpautop(n.val()),{format:"raw"})):(o.removeClass("tmce-active").addClass("html-active"),window.tinyMCE.execCommand(executeRem,!0,t))}).trigger("click"),e.bind("click",function(){l.filter(".switch-html").trigger("click")})})}!function(t){"use strict";t.SynthModal=function(t){var a=this,e={scope:this,modal_title:"",modal_class:"",modal_style:"",modal_bg_style:"",modal_content:"",modal_template:"",ajax_hook:"",nested_modal:null,save_callback:function(){},load_callback:function(){},close_callback:function(){}};a.options=jQuery.extend({},e,t),a.modal=jQuery('<div class="synth-modal'+a.options.modal_class+'" '+a.options.modal_style+"></div>"),a.background=jQuery('<div class="synth-modal-background" '+a.options.modal_bg_style+"></div>"),a.body=jQuery("body"),a.initialize()},t.SynthModal.prototype={initialize:function(){var t=this;t.create_modal(),t.bind_events()},create_modal:function(){var t=this,a=this.options.modal_content?t.options.modal_content:"",e='<h4 class="synth-modal-title">'+t.options.modal_title+"</h4>",o="",n='<div class="synth-modal-content">';n+='<div class="synth-modal-content-header"><span class="synth-modal-icon rman-syntaxstudio"></span>'+e+'<a href="#close" class="synth-modal-close-event close-button"></a></div>',n+='<div class="synth-modal-inner-content '+o+'">'+a+"</div>",n+='<div class="synth-modal-inner-footer">',"save"===t.options.modal_button?n+='<a href="#save" class="synth-modal-save-event modal-button button-primary">Save</a>':"close"===t.options.modal_button&&(n+='<a href="#close" class="synth-modal-close-event modal-button button-primary">Close</a>'),n+="</div></div>",t.body.append(t.modal).append(t.background),t.modal.html(n),t.options.modal_content?t.execute_load_callback():t.call_ajax_content()},bind_events:function(){var t=this;t.modal.on("click",".synth-modal-save-event",function(a){t.save(),a.preventDefault()}),t.modal.on("click",".synth-modal-close-event",function(a){t.close(),a.preventDefault()}),t.background.add("synth-modal-close-event",this.modal).on("click",function(a){t.close(),a.preventDefault()})},loaded:function(){var t=this;t.execute_load_callback(),syn_restaurant_manager_js_shortcodes.backend_modal_loaded()},save:function(){var t=this;t.execute_save_callback()},close:function(){var t=this;t.modal.remove(),t.background.remove(),t.options.close_callback.call()},execute_load_callback:function(){var a,e=this.options.load_callback,o=0;if(e instanceof Array)for(o in e)t.SynthModal.callback_support[e[o]].call(this);"string"==typeof e?(a=e.split(","),o in a&&t.SynthModal.callback_support[a[o]].call(this)):"function"==typeof e&&e.call()},execute_save_callback:function(){var t=this,a=t.modal.find("input, select, radio, textarea").not('[data-visibility="hidden"]').serializeArray(),e=t.convert_values(a),o=t.options.save_callback.call(t.options.scope,e,t.options.save_param);o!==!1&&t.close()},call_ajax_content:function(){var t=this,a=t.modal.find(".synth-modal-inner-content");jQuery.ajax({type:"POST",url:ajaxurl,dataType:"xml",data:{action:t.options.ajax_hook,params:t.options.modal_template},success:function(e){var o=jQuery(e).find("response_data").text();a.html(o),t.loaded()},error:function(t,a,e,o){var n=jQuery(t).find("response_data").text();jQuery(".wrap h2").after(n),alert(e,o)},complete:function(){}})},convert_values:function(t){var a={};return jQuery.each(t,function(){"undefined"!=typeof a[this.name]?(a[this.name].push||(a[this.name]=[a[this.name]]),a[this.name].push(this.value||"")):a[this.name]=this.value||""}),a}},t.SynthModal.callback_support=t.SynthModal.callback_support||{},t.SynthModal.callback_support.colorpicker=function(){syn_restaurant_manager_js_controls.color_picker_initialize()},t.SynthModal.callback_support.sortables=function(){modal_support_sortables()},t.SynthModal.callback_support.tinymce=function(){modal_support_tinymce(this)},t.SynthModal.callback_support.nested_element_builder=function(){syn_restaurant_manager_js_controls.nested_shortcode_control_initialize()},t.SynthModal.callback_support.table_builder=function(){syn_restaurant_manager_js_controls.table_builder_initialize()},t.SynthModal.callback_support.tabs_builder=function(){syn_restaurant_manager_js_controls.tabs_builder_initialize()}}(syn_restaurant_manager_js,window,document);