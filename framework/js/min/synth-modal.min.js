function modal_support_sortables(){jQuery(".sortables").sortable({handle:"span"})}function modal_support_tinymce(t){var o=t.modal.find(".synth_tinymce"),e=t.modal.find(".synth-modal-save-event");o.each(function(){var t=this.id,o=jQuery(this),a=o.parents(".wp-editor-wrap:eq(0)"),n=a.find("textarea.synth_tinymce"),l=a.find(".wp-switch-editor").removeAttr("onclick"),s={id:this.id,buttons:"strong,em,link,block,del,ins,img,ul,ol,li,code,spell,close"};tinyVersion=window.tinyMCE.majorVersion,executeAdd="mceAddControl",executeRem="mceRemoveControl",tinyVersion>=4&&(executeAdd="mceAddEditor",executeRem="mceRemoveEditor"),quicktags(s),QTags._buttonsInit(),l.bind("click",function(){var o=jQuery(this);o.is(".switch-tmce")?(a.removeClass("html-active").addClass("tmce-active"),window.tinyMCE.execCommand(executeAdd,!0,t),window.tinyMCE.get(t).setContent(window.switchEditors.wpautop(n.val()),{format:"raw"})):(a.removeClass("tmce-active").addClass("html-active"),window.tinyMCE.execCommand(executeRem,!0,t))}).trigger("click"),e.bind("click",function(){l.filter(".switch-html").trigger("click")})})}!function(t){t.synthModal=function(t){var o=this,e={scope:this,modal_title:"",modal_class:"",modal_style:"",modal_bg_style:"",modal_content:"",modal_template:"",ajax_hook:"",nested_modal:null,save_callback:function(){},load_callback:function(){},close_callback:function(){}};o.options=jQuery.extend({},e,t),o.modal=jQuery('<div class="synth-modal'+o.options.modal_class+'" '+o.options.modal_style+"></div>"),o.background=jQuery('<div class="synth-modal-background" '+o.options.modal_bg_style+"></div>"),o.body=jQuery("body"),o.initialize()},t.synthModal.prototype={initialize:function(){var t=this;t.create_modal(),t.bind_events()},create_modal:function(){var t=this,o=this.options.modal_content?t.options.modal_content:"",e='<h4 class="synth-modal-title">'+t.options.modal_title+"</h4>",a="",n='<div class="synth-modal-content">';n+='<div class="synth-modal-content-header"><span class="synth-modal-icon syn-iconsyntaxstudio"></span>'+e+'<a href="#close" class="synth-modal-close-event close-button"></a></div>',n+='<div class="synth-modal-inner-content '+a+'">'+o+"</div>",n+='<div class="synth-modal-inner-footer">',"save"===t.options.modal_button?n+='<a href="#save" class="synth-modal-save-event modal-button button-primary">Save</a>':"close"===t.options.modal_button&&(n+='<a href="#close" class="synth-modal-close-event modal-button button-primary">Close</a>'),n+="</div></div>",t.body.append(t.modal).append(t.background),t.modal.html(n),t.options.modal_content?t.execute_load_callback():t.call_ajax_content()},bind_events:function(){var t=this;t.modal.on("click",".synth-modal-save-event",function(o){t.save(),o.preventDefault()}),t.modal.on("click",".synth-modal-close-event",function(o){t.close(),o.preventDefault()}),t.background.add("synth-modal-close-event",this.modal).on("click",function(o){t.close(),o.preventDefault()})},loaded:function(){var t=this;t.execute_load_callback(),jQuery.synth_shortcodes.backend_modal_loaded()},save:function(){var t=this;t.execute_save_callback()},close:function(){var t=this;t.modal.remove(),t.background.remove(),t.options.close_callback.call()},execute_load_callback:function(){var o,e=this.options.load_callback,a=0;if(e instanceof Array)for(a in e)t.synthModal.callback_support[e[a]].call(this);"string"==typeof e?(o=e.split(","),a in o&&t.synthModal.callback_support[o[a]].call(this)):"function"==typeof e&&e.call()},execute_save_callback:function(){var t=this,o=t.modal.find("input, select, radio, textarea").not('[data-visibility="hidden"]').serializeArray(),e=t.convert_values(o),a=t.options.save_callback.call(t.options.scope,e,t.options.save_param);a!==!1&&t.close()},call_ajax_content:function(){var t=this,o=t.modal.find(".synth-modal-inner-content");jQuery.ajax({type:"POST",url:ajaxurl,dataType:"xml",data:{action:"synth_"+t.options.ajax_hook,params:t.options.modal_template},success:function(e){var a=jQuery(e).find("response_data").text();o.html(a),t.loaded()},error:function(t,o,e,a){var n=jQuery(t).find("response_data").text();jQuery(".wrap h2").after(n),alert(e,a)},complete:function(){}})},convert_values:function(t){var o={};return jQuery.each(t,function(){"undefined"!=typeof o[this.name]?(o[this.name].push||(o[this.name]=[o[this.name]]),o[this.name].push(this.value||"")):o[this.name]=this.value||""}),o}},t.synthModal.callback_support=t.synthModal.callback_support||{},t.synthModal.callback_support.colorpicker=function(){jQuery.synth_controls.color_picker_initialize()},t.synthModal.callback_support.sortables=function(){modal_support_sortables()},t.synthModal.callback_support.tinymce=function(){modal_support_tinymce(this)},t.synthModal.callback_support.nested_element_builder=function(){jQuery.synth_controls.nested_shortcode_control_initialize()},t.synthModal.callback_support.table_builder=function(){jQuery.synth_controls.table_builder_initialize()},t.synthModal.callback_support.tabs_builder=function(){jQuery.synth_controls.tabs_builder_initialize()}}(jQuery,window,document);